create DATABASE upang_eats;

CREATE TABLE users (
    user_id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
    student_id varchar(14) UNIQUE,
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    email VARCHAR(255) UNIQUE,
    password VARCHAR(255),
    phone_number VARCHAR(11),
    user_type ENUM('user', 'stall_owner') DEFAULT 'user'
);

CREATE TABLE stalls (
    stall_id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
    stall_name VARCHAR(255) NOT NULL,
    owner_id INT REFERENCES users(user_id),
    description TEXT,
    contact_number VARCHAR(11),
    image_url VARCHAR(255),
    image_banner_url VARCHAR(255),
    is_active BOOLEAN DEFAULT TRUE
);

CREATE TABLE food_items (
    item_id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
    stall_id INT REFERENCES stalls(stall_id),
    item_name VARCHAR(255) NOT NULL,
    description TEXT,
    price int(10) NOT NULL,
    image_url VARCHAR(255),
    is_available BOOLEAN DEFAULT TRUE,
    is_breakfast BOOLEAN DEFAULT FALSE,
    is_lunch BOOLEAN DEFAULT FALSE,
    is_merienda BOOLEAN DEFAULT FALSE
);

CREATE TABLE orders (
    order_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    user_id INT REFERENCES users(user_id),
    stall_id INT REFERENCES stalls(stall_id),
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    total_amount INT(10) NOT NULL,
    order_status ENUM('pending', 'accepted', 'ready', 'completed', 'cancelled') DEFAULT 'pending'
);

CREATE TABLE order_items (
    order_item_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    order_id INT REFERENCES orders(order_id),
    item_id INT REFERENCES food_items(item_id),
    quantity INT NOT NULL,
    subtotal INT(10) NOT NULL
);

CREATE TABLE bookmarks (
    bookmark_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    user_id INT REFERENCES users(user_id),
    stall_id INT REFERENCES stalls(stall_id)
);

CREATE TABLE categories (
    category_id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
    category_name VARCHAR(255) NOT NULL
);

-- (Many-to-Many relationship)
CREATE TABLE food_item_categories (
    food_item_id int NOT NULL REFERENCES food_items(item_id),
    category_id int NOT NULL REFERENCES categories(category_id),
    PRIMARY KEY (food_item_id, category_id)
);

//users record
INSERT INTO `users` (`user_id`, `student_id`, `first_name`, `last_name`, `email`, `password`, `phone_number`, `user_type`) VALUES
(1, '03-2223-040518', 'Christian Jose', 'Soriano', 'soriano.christianjose.m@gmail.com', 'password', NULL, 'user'),
(2, '03-2223-000000', 'Ritchmarc', 'Bustillo', 'ritchmarc.bustillo@gmail.com', 'password', NULL, 'stall_owner'),
(3, '03-2223-111111', 'Nervin', 'Ferrer', 'nervin.ferrer@gmail.com', 'password', NULL, 'stall_owner'),
(4, '03-2223-222222', 'Kenth', 'Marasigan', 'kenth.marasigan@gmail.com', 'password', NULL, 'stall_owner'),
(7, '03-2223-333333', 'Guerrero', 'Katherine', 'katherine.guerrero@gmail.com', 'password', NULL, 'stall_owner');

//stalls record
INSERT INTO `stalls` (`stall_id`, `stall_name`, `owner_id`, `description`, `contact_number`, `image_url`, `image_banner_url`, `is_active`) VALUES
(1, 'Boss Sisig!', 2, NULL, NULL, 'BossSisigProfile.jpg', 'BossSisigBanner.jpg', 1),
(2, 'Ninong Ryâ€™s Special Delicacy Stall', 3, NULL, NULL, 'NinongRySpecialDelicacy.jpg', 'NinongRySpecialDelicacyBanner.jpg', 1),
(3, 'Mekus Mekus Tayo Insan!', 4, NULL, NULL, 'MekusMekusTayoInsan.jpg', 'MekusMekusTayoInsanBanner.jpeg', 1),
(4, 'Masamsamit So Adele', 7, NULL, NULL, 'MasamsamitSoAdele.jpg', 'MasamsamitSoAdeleBanner.jpg', 1);

//Categories record
INSERT INTO `categories`(`category_name`) VALUES ('Snack'), ('Burger'), ('Rice Meal'), ('Drinks'), ('Noodles'), ('Dimsum'), ('Fries'), ('Bread');